{
  "global_model_results": {
    "patchcore": {
      "hazelnut": {
        "auroc": 1.0,
        "auprc": 1.0,
        "f1": 1.0,
        "accuracy": 1.0,
        "precision": 1.0,
        "recall": 1.0,
        "pixel_auroc": 0.9793175044557264,
        "pro": 0.8379525289113975
      },
      "carpet": {
        "auroc": 0.967687074829932,
        "auprc": 0.9885019070551304,
        "f1": 0.9508196721311475,
        "accuracy": 0.9340659340659341,
        "precision": 0.9830508474576272,
        "recall": 0.9206349206349206,
        "pixel_auroc": 0.9822937925179847,
        "pro": 0.7795051519039798
      },
      "zipper": {
        "auroc": 0.984375,
        "auprc": 0.994185358711756,
        "f1": 0.9595375722543352,
        "accuracy": 0.9396551724137931,
        "precision": 0.9325842696629213,
        "recall": 0.9880952380952381,
        "pixel_auroc": 0.9805027696003302,
        "pro": 0.7856911645808877
      }
    },
    "padim": {
      "hazelnut": {
        "auroc": 0.9744897959183674,
        "auprc": 0.9703963429695892,
        "f1": 0.9361702127659575,
        "accuracy": 0.9325842696629213,
        "precision": 0.9777777777777777,
        "recall": 0.8979591836734694,
        "pixel_auroc": 0.9523845682183026,
        "pro": 0.6479875195152589
      },
      "carpet": {
        "auroc": 0.9438775510204082,
        "auprc": 0.9786177533812437,
        "f1": 0.905982905982906,
        "accuracy": 0.8791208791208791,
        "precision": 0.9814814814814815,
        "recall": 0.8412698412698413,
        "pixel_auroc": 0.973437154787348,
        "pro": 0.719309643864228
      },
      "zipper": {
        "auroc": 0.8824404761904763,
        "auprc": 0.9447927937743672,
        "f1": 0.8757396449704142,
        "accuracy": 0.8189655172413793,
        "precision": 0.8705882352941177,
        "recall": 0.8809523809523809,
        "pixel_auroc": 0.9267769244121901,
        "pro": 0.6494271945270327
      }
    }
  },
  "thresholds_global": {
    "patchcore": {
      "hazelnut": 400.18903746275566,
      "carpet": 186.91836548951295,
      "zipper": 151.66495259786154
    },
    "padim": {
      "hazelnut": 41.73367449992412,
      "carpet": 27.7244876994743,
      "zipper": 18.04614202181498
    }
  },
  "gap_analysis": {
    "patchcore": {
      "hazelnut": {
        "per_class_auroc": 1.0,
        "global_auroc": 1.0,
        "gap": 0.0
      },
      "carpet": {
        "per_class_auroc": 0.9727891156462585,
        "global_auroc": 0.967687074829932,
        "gap": 0.005102040816326481
      },
      "zipper": {
        "per_class_auroc": 0.9817708333333334,
        "global_auroc": 0.984375,
        "gap": -0.0026041666666666297
      }
    },
    "padim": {
      "hazelnut": {
        "per_class_auroc": 0.9709183673469387,
        "global_auroc": 0.9744897959183674,
        "gap": -0.0035714285714286698
      },
      "carpet": {
        "per_class_auroc": 0.9586167800453514,
        "global_auroc": 0.9438775510204082,
        "gap": 0.01473922902494329
      },
      "zipper": {
        "per_class_auroc": 0.8616071428571429,
        "global_auroc": 0.8824404761904763,
        "gap": -0.02083333333333337
      }
    }
  },
  "identical_shortcut_analysis": {
    "patchcore": {
      "hazelnut": {
        "carpet": {
          "n_samples": 224,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 114.81879425048828,
          "max_score": 135.2587890625
        },
        "zipper": {
          "n_samples": 192,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 111.550537109375,
          "max_score": 132.35400390625
        }
      },
      "carpet": {
        "hazelnut": {
          "n_samples": 312,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 123.18689727783203,
          "max_score": 151.350341796875
        },
        "zipper": {
          "n_samples": 192,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 111.550537109375,
          "max_score": 132.35400390625
        }
      },
      "zipper": {
        "hazelnut": {
          "n_samples": 312,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 123.18689727783203,
          "max_score": 151.350341796875
        },
        "carpet": {
          "n_samples": 224,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 114.81879425048828,
          "max_score": 135.2587890625
        }
      }
    },
    "padim": {
      "hazelnut": {
        "carpet": {
          "n_samples": 224,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 15.38362979888916,
          "max_score": 21.436426162719727
        },
        "zipper": {
          "n_samples": 192,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 13.395611763000488,
          "max_score": 22.863866806030273
        }
      },
      "carpet": {
        "hazelnut": {
          "n_samples": 312,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 18.507165908813477,
          "max_score": 24.61635971069336
        },
        "zipper": {
          "n_samples": 192,
          "false_positives": 0,
          "fp_rate": 0.0,
          "mean_score": 13.395611763000488,
          "max_score": 22.863866806030273
        }
      },
      "zipper": {
        "hazelnut": {
          "n_samples": 312,
          "false_positives": 172,
          "fp_rate": 0.5512820512820513,
          "mean_score": 18.507165908813477,
          "max_score": 24.61635971069336
        },
        "carpet": {
          "n_samples": 224,
          "false_positives": 12,
          "fp_rate": 0.05357142857142857,
          "mean_score": 15.38362979888916,
          "max_score": 21.436426162719727
        }
      }
    }
  },
  "metadata": {
    "classes": [
      "hazelnut",
      "carpet",
      "zipper"
    ],
    "setting": "Model-Unified (per-class thresholds)",
    "patchcore_coreset_ratio": 0.05,
    "padim_backbone": "resnet50",
    "seed": 42
  },
  "files_generated": {
    "models": [
      "patchcore_global_clean.npy",
      "patchcore_global_clean_config.pth",
      "padim_global_clean.pt"
    ],
    "thresholds": [
      "global_thresholds.json"
    ],
    "results": [
      "global_results.json",
      "global_vs_perclass_gap.json",
      "identical_shortcut_analysis.json",
      "identical_shortcut_analysis_padim.json",
      "global_model_summary.csv"
    ],
    "visualizations": [
      "global_vs_perclass_gap.png",
      "identical_shortcut_confusion.png",
      "identical_shortcut_confusion_padim.png",
      "global_model_tsne.png"
    ]
  }
}